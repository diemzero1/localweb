{"ast":null,"code":"import _objectSpread from\"/home/iam/Documents/network/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import _regeneratorRuntime from\"/home/iam/Documents/network/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/iam/Documents/network/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/iam/Documents/network/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import ubusApi from'service/api/ubus-api';import React from'react';import\"../../../../translations/i18n\";import{DecompositionTreeGraph}from'@ant-design/graphs';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export var MeshTopo=function MeshTopo(){var _React$useState=React.useState({hits:[]}),_React$useState2=_slicedToArray(_React$useState,2),data=_React$useState2[0],setData=_React$useState2[1];var _React$useState3=React.useState(),_React$useState4=_slicedToArray(_React$useState3,2),data1=_React$useState4[0],setData1=_React$useState4[1];React.useEffect(function(){var fetchData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var result1,result;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return ubusApi.show_mesh_config();case 2:result1=_context.sent;setData1(result1.enabled_mode);_context.next=6;return ubusApi.show_mesh_topology();case 6:result=_context.sent;setData(result);case 8:case\"end\":return _context.stop();}}},_callee);}));return function fetchData(){return _ref.apply(this,arguments);};}();var interval=setInterval(function(){fetchData();},5000);return function(){return clearInterval(interval);};},[]);var config={data:data,data1:data1,width:1500,height:750,behaviors:['drag-canvas','zoom-canvas','drag-node'],layout:{type:'indented',direction:'LR',dropCap:false,indent:500,getHeight:function getHeight(){return 200;},getWidth:function getWidth(){return 500;}},nodeCfg:{autoWidth:true,size:[150,40],title:{containerStyle:{fill:'#0e4778'},style:function style(cfg){var _cfg$value;return{fill:(cfg===null||cfg===void 0?void 0:(_cfg$value=cfg.value)===null||_cfg$value===void 0?void 0:_cfg$value.title)==='青年'?'yellow':'#fff'};}},items:{containerStyle:{fill:'#fff'},style:function style(cfg,group,type){var styles={value:{fill:'#000'},text:{fill:'#000'},icon:{width:20,height:20}};return styles[type];}},nodeStateStyles:{hover:{stroke:'#1890ff',lineWidth:2}},style:{radius:[5,5,5,5]}},markerCfg:function markerCfg(cfg){var children=cfg.children;return{show:children===null||children===void 0?void 0:children.length};}};var config1={};if(data1===\"controller\"){return/*#__PURE__*/_jsx(DecompositionTreeGraph,_objectSpread({},config));}else{return/*#__PURE__*/_jsx(_Fragment,{});}};export default MeshTopo;","map":{"version":3,"names":["ubusApi","React","DecompositionTreeGraph","MeshTopo","useState","hits","data","setData","data1","setData1","useEffect","fetchData","show_mesh_config","result1","enabled_mode","show_mesh_topology","result","interval","setInterval","clearInterval","config","width","height","behaviors","layout","type","direction","dropCap","indent","getHeight","getWidth","nodeCfg","autoWidth","size","title","containerStyle","fill","style","cfg","value","items","group","styles","text","icon","nodeStateStyles","hover","stroke","lineWidth","radius","markerCfg","children","show","length","config1"],"sources":["/home/iam/Documents/network/src/components/antd/network/mesh/mesh_topo.tsx"],"sourcesContent":["import ubusApi from 'service/api/ubus-api'\nimport React, { Component, useReducer } from 'react';\nimport { message, Space, Table, Tag } from 'antd';\nimport { useTranslation } from \"react-i18next\";\nimport \"../../../../translations/i18n\";\nimport { render } from '@testing-library/react';\nimport { DecompositionTreeGraph, RadialTreeGraph } from '@ant-design/graphs';\nimport { t } from 'i18next';\nimport { escape } from 'querystring';\nexport const MeshTopo = () => {   \n    const [data, setData] = React.useState({ hits: [] });\n    const [data1, setData1] = React.useState();\n    React.useEffect(() => {\n        const fetchData = async () => {\n            const result1= await ubusApi.show_mesh_config()\n            setData1(result1.enabled_mode)\n            const result = await ubusApi.show_mesh_topology()\n            setData(result);\n        };\n        const interval = setInterval(() => {\n            fetchData();\n        }, 5000);\n        return () => clearInterval(interval);\n    },[]);\n    const config: any = {\n        data,\n        data1,\n        width: 1500,\n        height: 750,\n        behaviors: ['drag-canvas', 'zoom-canvas', 'drag-node'],\n        layout: {\n            type: 'indented',\n            direction: 'LR',\n            dropCap: false,\n            indent: 500,\n            getHeight: () => {\n                return 200;\n            },\n            getWidth: () => {   \n                return 500;\n            },\n        },\n        nodeCfg: {\n            autoWidth: true,\n            size: [150, 40],\n            title: {\n                containerStyle: {\n                    fill: '#0e4778',\n                },\n                style: (cfg: any) => {\n                    return {\n                        fill: cfg?.value?.title === '青年' ? 'yellow' : '#fff',\n                    };\n                },\n            },\n            items: {    \n                containerStyle: {\n                    fill: '#fff',\n                },\n                style: (cfg: any, group: any, type: any) => {\n                    const styles: any = {\n                        value: {\n                            fill: '#000',\n                        },\n                        text: {\n                            fill: '#000',\n                        },\n                        icon: {\n                            width: 20,\n                            height: 20,\n                        },\n                    };\n                    return styles[type];\n                },\n            },\n            nodeStateStyles: {\n                hover: {\n                    stroke: '#1890ff',\n                    lineWidth: 2,\n                },\n            },\n            style: {\n                radius: [5, 5, 5, 5],\n            },\n        },\n        markerCfg: (cfg: any) => {\n            const { children } = cfg;\n            return {\n                show: children?.length,\n            };\n        },\n    };\n    const config1: any = {}\n    if(data1 === \"controller\"){\n    return <DecompositionTreeGraph {...config} />;\n    }\n    else{\n        return <></>;\n    }\n}\nexport default MeshTopo;"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}