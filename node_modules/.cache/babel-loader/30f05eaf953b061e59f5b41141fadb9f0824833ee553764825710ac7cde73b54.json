{"ast":null,"code":"import { __assign, __spreadArrays } from \"tslib\";\nimport { Util } from '@antv/g2';\nimport { get } from '@antv/util';\nimport { deepAssign } from '../utils';\nimport { getCanvasPattern } from '../utils/pattern';\n/**\n * Pattern é€šé“ï¼Œå¤„ç†å›¾æ¡ˆå¡«å……\n * ğŸš€ ç›®å‰æ”¯æŒå›¾è¡¨ç±»å‹ï¼šé¥¼å›¾ã€æŸ±çŠ¶å›¾ã€æ¡å½¢å›¾ã€ç‰çå›¾ç­‰ï¼ˆä¸æ”¯æŒåœ¨å¤š view å›¾è¡¨ä¸­ï¼Œåç»­æŒ‰éœ€æ‰©å±•ï¼‰\n *\n * @param key key of style property\n * @returns\n */\nexport function pattern(key) {\n  var _this = this;\n  return function (params) {\n    var _a;\n    var options = params.options,\n      chart = params.chart;\n    var patternOption = options.pattern;\n    // æ²¡æœ‰ pattern é…ç½®ï¼Œåˆ™ç›´æ¥è¿”å›\n    if (!patternOption) {\n      return params;\n    }\n    /** ~~~~~~~ è¿›è¡Œè´´å›¾å›¾æ¡ˆå¤„ç† ~~~~~~~ */\n    var style = function (datum) {\n      var _a, _b, _c;\n      var args = [];\n      for (var _i = 1; _i < arguments.length; _i++) {\n        args[_i - 1] = arguments[_i];\n      }\n      var defaultColor = chart.getTheme().defaultColor;\n      var color = defaultColor;\n      var colorAttribute = (_b = (_a = chart.geometries) === null || _a === void 0 ? void 0 : _a[0]) === null || _b === void 0 ? void 0 : _b.getAttribute('color');\n      if (colorAttribute) {\n        var colorField = colorAttribute.getFields()[0];\n        var seriesValue = get(datum, colorField);\n        color = Util.getMappingValue(colorAttribute, seriesValue, ((_c = colorAttribute.values) === null || _c === void 0 ? void 0 : _c[0]) || defaultColor);\n      }\n      var pattern = patternOption;\n      // 1. å¦‚æœ patternOption æ˜¯ä¸€ä¸ªå›è°ƒï¼Œåˆ™è·å–å›è°ƒç»“æœã€‚`(datum: Datum, color: string) => CanvasPattern`\n      if (typeof patternOption === 'function') {\n        pattern = patternOption.call(_this, datum, color);\n      }\n      // 2. å¦‚æœ pattern ä¸æ˜¯ CanvasPatternï¼Œåˆ™è¿›ä¸€æ­¥å¤„ç†ï¼Œå¦åˆ™ç›´æ¥èµ‹äºˆç»™ fill\n      if (pattern instanceof CanvasPattern === false) {\n        // é€šè¿‡ createPattern(PatternStyle) è½¬æ¢ä¸º CanvasPattern\n        pattern = getCanvasPattern(deepAssign({}, {\n          cfg: {\n            backgroundColor: color\n          }\n        }, pattern));\n      }\n      var styleOption = options[key];\n      return __assign(__assign({}, typeof styleOption === 'function' ? styleOption.call.apply(styleOption, __spreadArrays([_this, datum], args)) : styleOption || {}), {\n        fill: pattern || color\n      });\n    };\n    return deepAssign({}, params, {\n      options: (_a = {}, _a[key] = style, _a)\n    });\n  };\n}","map":{"version":3,"mappings":";AAAA,SAASA,IAAI,QAAQ,UAAU;AAC/B,SAASC,GAAG,QAAQ,YAAY;AAGhC,SAASC,UAAU,QAAQ,UAAU;AACrC,SAASC,gBAAgB,QAAQ,kBAAkB;AAOnD;;;;;;;AAOA,OAAM,SAAUC,OAAO,CAACC,GAAW;EAAnC;EACE,OAAO,UAAgEC,MAAiB;;IAC9E,WAAO,GAAYA,MAAM,QAAlB;MAAEC,KAAK,GAAKD,MAAM,MAAX;IACd,IAASE,aAAa,GAAKC,OAAO,QAAZ;IAE9B;IACA,IAAI,CAACD,aAAa,EAAE;MAClB,OAAOF,MAAM;;IAGf;IAEA,IAAMI,KAAK,GAAc,UAACC,KAAa;;MAAE;WAAA,UAAc,EAAdC,qBAAc,EAAdA,IAAc;QAAdC;;MAC/B,gBAAY,GAAKN,KAAK,CAACO,QAAQ,EAAE,aAArB;MACpB,IAAIC,KAAK,GAAGC,YAAY;MAExB,IAAMC,cAAc,eAAGV,KAAK,CAACW,UAAU,0CAAG,CAAC,2CAAGC,YAAY,CAAC,OAAO,CAAC;MACnE,IAAIF,cAAc,EAAE;QAClB,IAAMG,UAAU,GAAGH,cAAc,CAACI,SAAS,EAAE,CAAC,CAAC,CAAC;QAChD,IAAMC,WAAW,GAAGrB,GAAG,CAACU,KAAK,EAAES,UAAU,CAAC;QAC1CL,KAAK,GAAGf,IAAI,CAACuB,eAAe,CAACN,cAAc,EAAEK,WAAW,EAAE,qBAAc,CAACE,MAAM,0CAAG,CAAC,MAAKR,YAAY,CAAC;;MAGvG,IAAIZ,OAAO,GAAkBI,aAA8B;MAE3D;MACA,IAAI,OAAOA,aAAa,KAAK,UAAU,EAAE;QACvCJ,OAAO,GAAGI,aAAa,CAACiB,IAAI,CAACC,KAAI,EAAEf,KAAK,EAAEI,KAAK,CAAC;;MAGlD;MACA,IAAIX,OAAO,YAAYuB,aAAa,KAAK,KAAK,EAAE;QAC9C;QACAvB,OAAO,GAAGD,gBAAgB,CAACD,UAAU,CAAC,EAAE,EAAE;UAAE0B,GAAG,EAAE;YAAEC,eAAe,EAAEd;UAAK;QAAE,CAAE,EAAEX,OAAO,CAAC,CAAC;;MAG1F,IAAM0B,WAAW,GAAGrB,OAAO,CAACJ,GAAG,CAAc;MAE7C,6BACM,OAAOyB,WAAW,KAAK,UAAU,GAAGA,WAAW,CAACL,IAAI,OAAhBK,WAAW,kBAAMJ,KAAI,EAAEf,KAAK,GAAKE,IAAI,KAAIiB,WAAW,IAAI,EAAE,CAAC;QACnGC,IAAI,EAAE3B,OAAO,IAAIW;MAAK;IAE1B,CAAC;IAED,OAAOb,UAAU,CAAC,EAAE,EAAEI,MAAM,EAAE;MAAEG,OAAO,YAAIuB,GAAC3B,GAAG,IAAGK,KAAK;IAAE,CAAE,CAAC;EAC9D,CAAC;AACH","names":["Util","get","deepAssign","getCanvasPattern","pattern","key","params","chart","patternOption","options","style","datum","_i","args","getTheme","color","defaultColor","colorAttribute","geometries","getAttribute","colorField","getFields","seriesValue","getMappingValue","values","call","_this","CanvasPattern","cfg","backgroundColor","styleOption","fill","_a"],"sources":["/home/iam/Documents/LocalWeb-master/node_modules/@antv/g2plot/src/adaptor/pattern.ts"],"sourcesContent":["import { Util } from '@antv/g2';\nimport { get } from '@antv/util';\nimport { Params } from '../core/adaptor';\nimport { Datum, Options, StyleAttr } from '../types';\nimport { deepAssign } from '../utils';\nimport { getCanvasPattern } from '../utils/pattern';\n\n/**\n * ä½¿ç”¨ Pattern é€šé“çš„ optionsï¼Œè¦æ±‚æœ‰ colorField/seriesField/stackField ä½œä¸ºåˆ†ç±»å­—æ®µï¼ˆè¿›è¡Œé¢œè‰²æ˜ å°„ï¼‰\n */\ntype OptionsRequiredInPattern = Omit<Options, 'data'>;\n\n/**\n * Pattern é€šé“ï¼Œå¤„ç†å›¾æ¡ˆå¡«å……\n * ğŸš€ ç›®å‰æ”¯æŒå›¾è¡¨ç±»å‹ï¼šé¥¼å›¾ã€æŸ±çŠ¶å›¾ã€æ¡å½¢å›¾ã€ç‰çå›¾ç­‰ï¼ˆä¸æ”¯æŒåœ¨å¤š view å›¾è¡¨ä¸­ï¼Œåç»­æŒ‰éœ€æ‰©å±•ï¼‰\n *\n * @param key key of style property\n * @returns\n */\nexport function pattern(key: string) {\n  return <O extends OptionsRequiredInPattern = OptionsRequiredInPattern>(params: Params<O>): Params<O> => {\n    const { options, chart } = params;\n    const { pattern: patternOption } = options;\n\n    // æ²¡æœ‰ pattern é…ç½®ï¼Œåˆ™ç›´æ¥è¿”å›\n    if (!patternOption) {\n      return params;\n    }\n\n    /** ~~~~~~~ è¿›è¡Œè´´å›¾å›¾æ¡ˆå¤„ç† ~~~~~~~ */\n\n    const style: StyleAttr = (datum?: Datum, ...args: any[]) => {\n      const { defaultColor } = chart.getTheme();\n      let color = defaultColor;\n\n      const colorAttribute = chart.geometries?.[0]?.getAttribute('color');\n      if (colorAttribute) {\n        const colorField = colorAttribute.getFields()[0];\n        const seriesValue = get(datum, colorField);\n        color = Util.getMappingValue(colorAttribute, seriesValue, colorAttribute.values?.[0] || defaultColor);\n      }\n\n      let pattern: CanvasPattern = patternOption as CanvasPattern;\n\n      // 1. å¦‚æœ patternOption æ˜¯ä¸€ä¸ªå›è°ƒï¼Œåˆ™è·å–å›è°ƒç»“æœã€‚`(datum: Datum, color: string) => CanvasPattern`\n      if (typeof patternOption === 'function') {\n        pattern = patternOption.call(this, datum, color);\n      }\n\n      // 2. å¦‚æœ pattern ä¸æ˜¯ CanvasPatternï¼Œåˆ™è¿›ä¸€æ­¥å¤„ç†ï¼Œå¦åˆ™ç›´æ¥èµ‹äºˆç»™ fill\n      if (pattern instanceof CanvasPattern === false) {\n        // é€šè¿‡ createPattern(PatternStyle) è½¬æ¢ä¸º CanvasPattern\n        pattern = getCanvasPattern(deepAssign({}, { cfg: { backgroundColor: color } }, pattern));\n      }\n\n      const styleOption = options[key] as StyleAttr;\n\n      return {\n        ...(typeof styleOption === 'function' ? styleOption.call(this, datum, ...args) : styleOption || {}),\n        fill: pattern || color,\n      };\n    };\n\n    return deepAssign({}, params, { options: { [key]: style } });\n  };\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}