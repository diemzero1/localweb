{"ast":null,"code":"import _regeneratorRuntime from\"/home/iam/Documents/network/node_modules/@babel/runtime/helpers/esm/regeneratorRuntime.js\";import _asyncToGenerator from\"/home/iam/Documents/network/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/home/iam/Documents/network/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{Form,Input,Button,message,Select}from'antd';import React from'react';import ubusApi from'service/api/ubus-api';import{useTranslation}from\"react-i18next\";import\"../../../../translations/i18n\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export var VlanEdit=function VlanEdit(props){var _useTranslation=useTranslation(),t=_useTranslation.t;var pattern1=/^([-]?[1-9][0-9]*|0)$/;var item=props.item,onDone=props.onDone,value=props.value,handleChange=props.handleChange,optionsParentInterface=props.optionsParentInterface;console.log(value);var _Form$useForm=Form.useForm(),_Form$useForm2=_slicedToArray(_Form$useForm,1),form=_Form$useForm2[0];var refreshData=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee(){var name,vid,dev;return _regeneratorRuntime().wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(item){name=item.name,vid=item.vid,dev=item.dev;form.setFieldsValue({name:name,mode:value,interface:dev,vid:vid});}case 1:case\"end\":return _context.stop();}}},_callee);}));return function refreshData(){return _ref.apply(this,arguments);};}();React.useEffect(function(){refreshData();},[]);var refreshPage=function refreshPage(){window.location.reload();};function randomName(length){var result='';var characters='ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';var charactersLength=characters.length;for(var i=0;i<length;i++){result+=characters.charAt(Math.floor(Math.random()*charactersLength));}return result;}var onFinish=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime().mark(function _callee2(values){var vlan,key,_vlan,_key;return _regeneratorRuntime().wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:if(!(values.id==null)){_context2.next=11;break;}if(!(values.mode==\"access\")){_context2.next=5;break;}_context2.next=4;return ubusApi.config_network_vlan(\"access\",\"add\",randomName(4),values.name,values.vid,values.interface);case 4:vlan=_context2.sent;case 5:key='updatable';message.loading({content:t('loading'),key:key});setTimeout(function(){message.success({content:t('success'),key:key,duration:2});},1000);setTimeout(function(){window.location.reload();},1500);_context2.next=19;break;case 11:if(!(values.mode==\"access\")){_context2.next=15;break;}_context2.next=14;return ubusApi.config_network_vlan(\"access\",\"add\",values.id,values.name,values.vid,values.interface);case 14:_vlan=_context2.sent;case 15:_key='updatable';message.loading({content:t('loading'),key:_key});setTimeout(function(){message.success({content:t('success'),key:_key,duration:2});},1000);setTimeout(function(){window.location.reload();},1500);case 19:case\"end\":return _context2.stop();}}},_callee2);}));return function onFinish(_x){return _ref2.apply(this,arguments);};}();return/*#__PURE__*/_jsxs(Form,{form:form,labelCol:{span:6},wrapperCol:{span:16},onFinish:onFinish,children:[/*#__PURE__*/_jsx(Form.Item,{label:t('id'),name:\"id\",hidden:true,children:/*#__PURE__*/_jsx(Input,{disabled:true})}),/*#__PURE__*/_jsx(Form.Item,{label:t('mode'),name:\"mode\",rules:[{required:true,message:String(t(\"error_fill\"))}],children:/*#__PURE__*/_jsx(Select// defaultValue=\"Select Mode\"\n,{onChange:handleChange,value:value,options:[{value:\"access\",label:\"Access\"}]})}),/*#__PURE__*/_jsx(Form.Item,{label:t('interface'),name:\"interface\",children:/*#__PURE__*/_jsx(Select,{mode:\"tags\",options:optionsParentInterface})}),/*#__PURE__*/_jsx(Form.Item,{label:\"VLAN ID\",name:\"vid\",rules:[{required:true,message:String(t(\"error_fill\"))},{validator:function validator(_,values){return values>4094||values<1?Promise.reject(t('vlanid_could_not_be_larger_than_4094')):Promise.resolve();}},{validator:function validator(_,value){return pattern1.test(value)?Promise.resolve():Promise.reject(t('enter_number'));}}],children:/*#__PURE__*/_jsx(Input,{})}),/*#__PURE__*/_jsx(Form.Item,{wrapperCol:{offset:6,span:16},children:/*#__PURE__*/_jsx(Button,{type:\"primary\",htmlType:\"submit\",children:t('submit')})})]});};","map":{"version":3,"names":["Form","Input","Button","message","Select","React","ubusApi","useTranslation","VlanEdit","props","t","pattern1","item","onDone","value","handleChange","optionsParentInterface","console","log","useForm","form","refreshData","name","vid","dev","setFieldsValue","mode","interface","useEffect","refreshPage","window","location","reload","randomName","length","result","characters","charactersLength","i","charAt","Math","floor","random","onFinish","values","id","config_network_vlan","vlan","key","loading","content","setTimeout","success","duration","span","required","String","label","validator","_","Promise","reject","resolve","test","offset"],"sources":["/home/iam/Documents/network/src/components/antd/network/vlan/edit.tsx"],"sourcesContent":["import { message as antdMessage, Form, Input, Button, message, Select } from 'antd'\nimport { access } from 'fs'\nimport React from 'react'\nimport ubusApi from 'service/api/ubus-api'\nimport { useTranslation } from \"react-i18next\"\nimport \"../../../../translations/i18n\"\n\nexport const VlanEdit = (props: any) => {\n    const {t} = useTranslation()\n    let pattern1 = /^([-]?[1-9][0-9]*|0)$/\n    const { item, onDone, value, handleChange,optionsParentInterface } = props\n    console.log(value)\n    const [form] = Form.useForm()\n    const refreshData = async () => {\n        if (item) {\n            const { name, vid,dev, } = item\n            form.setFieldsValue({\n                name:name, mode:value, interface:dev, vid:vid\n            })\n        }\n    }\n    React.useEffect(() => {\n        refreshData()\n    }, [])\n\n    const refreshPage = ()=>{\n        window.location.reload()\n    }\n    function randomName(length: number) {\n        let result = ''\n        const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789'\n        const charactersLength = characters.length\n        for (let i = 0; i < length; i++) {\n          result += characters.charAt(Math.floor(Math.random() * charactersLength))\n        }\n        return result\n    }\n    const onFinish = async (values: any) => {\n\n        if (values.id == null) {\n\n            if (values.mode == \"access\") {\n                const vlan = await ubusApi.config_network_vlan(\"access\", \"add\", randomName(4), values.name, values.vid, values.interface)\n            }\n            const key = 'updatable';\n            message.loading({ content: t('loading'), key });\n            setTimeout(() => {\n                message.success({ content: t('success'), key, duration: 2 });\n            }, 1000);\n            setTimeout(() => {\n                window.location.reload()\n            }, 1500);\n\n        }\n        else {\n\n            if (values.mode == \"access\") {\n                const vlan = await ubusApi.config_network_vlan(\"access\", \"add\", values.id, values.name, values.vid, values.interface)\n            }\n            const key = 'updatable';\n            message.loading({ content: t('loading'), key });\n            setTimeout(() => {\n                message.success({ content: t('success'), key, duration: 2 });\n            }, 1000);\n            setTimeout(() => {\n                window.location.reload()\n            }, 1500);\n        }\n    }\n    \n    return (\n        <Form\n            form={form}\n            labelCol={{ span: 6 }}\n            wrapperCol={{ span: 16 }}\n            onFinish={onFinish}\n        >\n            <Form.Item label={t('id')} name=\"id\" hidden \n            >\n                <Input disabled></Input>\n            </Form.Item>\n            <Form.Item label={t('mode')} name=\"mode\" rules={[{ required: true,  message: String(t(\"error_fill\"))  }]}\n            >\n                <Select\n                    // defaultValue=\"Select Mode\"\n                    onChange={handleChange}\n                    value={value}\n                    options={[\n                        {\n                            value: \"access\",\n                            label: \"Access\"\n                        },\n                    ]}\n                ></Select>\n            </Form.Item>\n            <Form.Item label={t('interface')} name=\"interface\"\n            >\n                <Select\n                    mode=\"tags\"\n                    options={optionsParentInterface}\n                ></Select>\n            </Form.Item>\n            <Form.Item label=\"VLAN ID\" name=\"vid\"\n                rules={[\n                    { required: true, message: String(t(\"error_fill\"))  },\n                    {\n                      validator: (_, values) =>\n                        values > 4094 || values < 1 ? Promise.reject(t('vlanid_could_not_be_larger_than_4094')) : Promise.resolve()\n                    },\n                    {\n                        validator: (_, value) =>\n                        pattern1.test(value) ? Promise.resolve() : Promise.reject(t('enter_number'))\n                    }\n                ]}\n            >\n                <Input></Input>\n            </Form.Item>\n\n\n            <Form.Item wrapperCol={{ offset: 6, span: 16 }}>\n                <Button\n                    type='primary'\n                    htmlType=\"submit\"\n                >\n                    {t('submit')}\n                </Button>\n            </Form.Item>\n\n        </Form>\n    )\n}\n\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}