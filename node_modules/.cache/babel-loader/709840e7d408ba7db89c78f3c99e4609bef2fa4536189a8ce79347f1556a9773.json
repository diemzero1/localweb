{"ast":null,"code":"import { __extends } from \"tslib\";\nimport { ext } from '@antv/matrix-util';\nimport { Action } from '..';\nimport { distance } from '../util';\nvar MIN_DISTANCE = 5;\n/**\n * @ignore\n * View 移动的 Action\n */\nvar Move = /** @class */function (_super) {\n  __extends(Move, _super);\n  function Move() {\n    var _this = _super !== null && _super.apply(this, arguments) || this;\n    _this.starting = false;\n    _this.isMoving = false;\n    // private cacheRange = null;\n    _this.startPoint = null;\n    _this.startMatrix = null;\n    return _this;\n  }\n  /**\n   * 开始移动\n   */\n  Move.prototype.start = function () {\n    this.starting = true;\n    this.startPoint = this.context.getCurrentPoint();\n    // 缓存开始时的矩阵，防止反复拖拽\n    this.startMatrix = this.context.view.middleGroup.getMatrix();\n  };\n  /**\n   * 移动\n   */\n  Move.prototype.move = function () {\n    if (!this.starting) {\n      return;\n    }\n    var startPoint = this.startPoint;\n    var currentPoint = this.context.getCurrentPoint();\n    var d = distance(startPoint, currentPoint);\n    if (d > MIN_DISTANCE && !this.isMoving) {\n      this.isMoving = true;\n    }\n    if (this.isMoving) {\n      var view = this.context.view;\n      var matrix = ext.transform(this.startMatrix, [['t', currentPoint.x - startPoint.x, currentPoint.y - startPoint.y]]);\n      view.backgroundGroup.setMatrix(matrix);\n      view.foregroundGroup.setMatrix(matrix);\n      view.middleGroup.setMatrix(matrix);\n    }\n  };\n  /**\n   * 结束移动\n   */\n  Move.prototype.end = function () {\n    if (this.isMoving) {\n      this.isMoving = false;\n    }\n    this.startMatrix = null;\n    this.starting = false;\n    this.startPoint = null;\n  };\n  /**\n   * 回滚\n   */\n  Move.prototype.reset = function () {\n    this.starting = false;\n    this.startPoint = null;\n    this.isMoving = false;\n    var view = this.context.view;\n    view.backgroundGroup.resetMatrix();\n    view.foregroundGroup.resetMatrix();\n    view.middleGroup.resetMatrix();\n    this.isMoving = false;\n  };\n  return Move;\n}(Action);\nexport default Move;","map":{"version":3,"mappings":";AAAA,SAASA,GAAG,QAAQ,mBAAmB;AACvC,SAASC,MAAM,QAAQ,IAAI;AAC3B,SAASC,QAAQ,QAAQ,SAAS;AAElC,IAAMC,YAAY,GAAG,CAAC;AAEtB;;;;AAIA;EAAmBC;EAAnB;IAAA;IACUC,cAAQ,GAAG,KAAK;IAChBA,cAAQ,GAAG,KAAK;IACxB;IACQA,gBAAU,GAAG,IAAI;IACjBA,iBAAW,GAAG,IAAI;;EA6D5B;EA5DE;;;EAGOC,oBAAK,GAAZ;IACE,IAAI,CAACC,QAAQ,GAAG,IAAI;IACpB,IAAI,CAACC,UAAU,GAAG,IAAI,CAACC,OAAO,CAACC,eAAe,EAAE;IAChD;IACA,IAAI,CAACC,WAAW,GAAG,IAAI,CAACF,OAAO,CAACG,IAAI,CAACC,WAAW,CAACC,SAAS,EAAE;EAC9D,CAAC;EAED;;;EAGOR,mBAAI,GAAX;IACE,IAAI,CAAC,IAAI,CAACC,QAAQ,EAAE;MAClB;;IAEF,IAAMC,UAAU,GAAG,IAAI,CAACA,UAAU;IAClC,IAAMO,YAAY,GAAG,IAAI,CAACN,OAAO,CAACC,eAAe,EAAE;IACnD,IAAMM,CAAC,GAAGd,QAAQ,CAACM,UAAU,EAAEO,YAAY,CAAC;IAC5C,IAAIC,CAAC,GAAGb,YAAY,IAAI,CAAC,IAAI,CAACc,QAAQ,EAAE;MACtC,IAAI,CAACA,QAAQ,GAAG,IAAI;;IAEtB,IAAI,IAAI,CAACA,QAAQ,EAAE;MACjB,IAAML,IAAI,GAAG,IAAI,CAACH,OAAO,CAACG,IAAI;MAC9B,IAAMM,MAAM,GAAGlB,GAAG,CAACmB,SAAS,CAAC,IAAI,CAACR,WAAW,EAAE,CAC7C,CAAC,GAAG,EAAEI,YAAY,CAACK,CAAC,GAAGZ,UAAU,CAACY,CAAC,EAAEL,YAAY,CAACM,CAAC,GAAGb,UAAU,CAACa,CAAC,CAAC,CACpE,CAAC;MACFT,IAAI,CAACU,eAAe,CAACC,SAAS,CAACL,MAAM,CAAC;MACtCN,IAAI,CAACY,eAAe,CAACD,SAAS,CAACL,MAAM,CAAC;MACtCN,IAAI,CAACC,WAAW,CAACU,SAAS,CAACL,MAAM,CAAC;;EAEtC,CAAC;EAED;;;EAGOZ,kBAAG,GAAV;IACE,IAAI,IAAI,CAACW,QAAQ,EAAE;MACjB,IAAI,CAACA,QAAQ,GAAG,KAAK;;IAEvB,IAAI,CAACN,WAAW,GAAG,IAAI;IACvB,IAAI,CAACJ,QAAQ,GAAG,KAAK;IACrB,IAAI,CAACC,UAAU,GAAG,IAAI;EACxB,CAAC;EAED;;;EAGOF,oBAAK,GAAZ;IACE,IAAI,CAACC,QAAQ,GAAG,KAAK;IACrB,IAAI,CAACC,UAAU,GAAG,IAAI;IACtB,IAAI,CAACS,QAAQ,GAAG,KAAK;IAErB,IAAML,IAAI,GAAG,IAAI,CAACH,OAAO,CAACG,IAAI;IAC9BA,IAAI,CAACU,eAAe,CAACG,WAAW,EAAE;IAClCb,IAAI,CAACY,eAAe,CAACC,WAAW,EAAE;IAClCb,IAAI,CAACC,WAAW,CAACY,WAAW,EAAE;IAC9B,IAAI,CAACR,QAAQ,GAAG,KAAK;EACvB,CAAC;EACH,WAAC;AAAD,CAAC,CAlEkBhB,MAAM;AAoEzB,eAAeK,IAAI","names":["ext","Action","distance","MIN_DISTANCE","__extends","_this","Move","starting","startPoint","context","getCurrentPoint","startMatrix","view","middleGroup","getMatrix","currentPoint","d","isMoving","matrix","transform","x","y","backgroundGroup","setMatrix","foregroundGroup","resetMatrix"],"sources":["/home/iam/Documents/network/node_modules/@antv/g2/src/interaction/action/view/move.ts"],"sourcesContent":["import { ext } from '@antv/matrix-util';\nimport { Action } from '..';\nimport { distance } from '../util';\n\nconst MIN_DISTANCE = 5;\n\n/**\n * @ignore\n * View 移动的 Action\n */\nclass Move extends Action {\n  private starting = false;\n  private isMoving = false;\n  // private cacheRange = null;\n  private startPoint = null;\n  private startMatrix = null;\n  /**\n   * 开始移动\n   */\n  public start() {\n    this.starting = true;\n    this.startPoint = this.context.getCurrentPoint();\n    // 缓存开始时的矩阵，防止反复拖拽\n    this.startMatrix = this.context.view.middleGroup.getMatrix();\n  }\n\n  /**\n   * 移动\n   */\n  public move() {\n    if (!this.starting) {\n      return;\n    }\n    const startPoint = this.startPoint;\n    const currentPoint = this.context.getCurrentPoint();\n    const d = distance(startPoint, currentPoint);\n    if (d > MIN_DISTANCE && !this.isMoving) {\n      this.isMoving = true;\n    }\n    if (this.isMoving) {\n      const view = this.context.view;\n      const matrix = ext.transform(this.startMatrix, [\n        ['t', currentPoint.x - startPoint.x, currentPoint.y - startPoint.y],\n      ]);\n      view.backgroundGroup.setMatrix(matrix);\n      view.foregroundGroup.setMatrix(matrix);\n      view.middleGroup.setMatrix(matrix);\n    }\n  }\n\n  /**\n   * 结束移动\n   */\n  public end() {\n    if (this.isMoving) {\n      this.isMoving = false;\n    }\n    this.startMatrix = null;\n    this.starting = false;\n    this.startPoint = null;\n  }\n\n  /**\n   * 回滚\n   */\n  public reset() {\n    this.starting = false;\n    this.startPoint = null;\n    this.isMoving = false;\n\n    const view = this.context.view;\n    view.backgroundGroup.resetMatrix();\n    view.foregroundGroup.resetMatrix();\n    view.middleGroup.resetMatrix();\n    this.isMoving = false;\n  }\n}\n\nexport default Move;\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}