{"ast":null,"code":"import { isFunction } from '@antv/util';\nvar MyWorker = /** @class */function () {\n  function MyWorker(url) {\n    var _this = this;\n    this.queue = [];\n    this.worker = new Worker(url);\n    this.worker.onmessage = function (e) {\n      var _a;\n      (_a = _this.queue.shift()) === null || _a === void 0 ? void 0 : _a.resolve(e);\n    };\n    this.worker.onmessageerror = function (e) {\n      var _a;\n      console.warn('[AntV G2] Web worker is not available');\n      (_a = _this.queue.shift()) === null || _a === void 0 ? void 0 : _a.reject(e);\n    };\n  }\n  MyWorker.prototype.post = function (params, onError) {\n    var _this = this;\n    return new Promise(function (resolve, reject) {\n      _this.queue.push({\n        resolve: resolve,\n        reject: reject\n      });\n      try {\n        _this.worker.postMessage(params);\n      } catch (e) {\n        console.warn('[AntV G2] Web worker is not available');\n        isFunction(onError) && onError();\n      }\n    });\n  };\n  MyWorker.prototype.destroy = function () {\n    this.worker.terminate();\n  };\n  return MyWorker;\n}();\nexport function createWorker(f) {\n  if (typeof window === 'undefined') return;\n  var blob;\n  try {\n    blob = new Blob([f.toString()], {\n      type: 'application/javascript'\n    });\n  } catch (e) {\n    // @ts-ignore\n    blob = new window.BlobBuilder();\n    blob.append(f.toString());\n    blob = blob.getBlob();\n  }\n  return new MyWorker(URL.createObjectURL(blob));\n}","map":{"version":3,"mappings":"AAAA,SAASA,UAAU,QAAQ,YAAY;AAEvC;EAIE,kBAAYC,GAAG;IAAf;IAHA,UAAK,GAAU,EAAE;IAIf,IAAI,CAACC,MAAM,GAAG,IAAIC,MAAM,CAACF,GAAG,CAAC;IAC7B,IAAI,CAACC,MAAM,CAACE,SAAS,GAAG,UAACC,CAAe;;MACtC,WAAI,CAACC,KAAK,CAACC,KAAK,EAAE,0CAAEC,OAAO,CAACH,CAAC,CAAC;IAChC,CAAC;IACD,IAAI,CAACH,MAAM,CAACO,cAAc,GAAG,UAACJ,CAAe;;MAC3CK,OAAO,CAACC,IAAI,CAAC,uCAAuC,CAAC;MACrD,WAAI,CAACL,KAAK,CAACC,KAAK,EAAE,0CAAEK,MAAM,CAACP,CAAC,CAAC;IAC/B,CAAC;EACH;EAEAQ,uBAAI,GAAJ,UAAKC,MAAM,EAAEC,OAAmB;IAAhC;IACE,OAAO,IAAIC,OAAO,CAAC,UAACR,OAAO,EAAEI,MAAM;MACjCK,KAAI,CAACX,KAAK,CAACY,IAAI,CAAC;QAAEV,OAAO;QAAEI,MAAM;MAAA,CAAE,CAAC;MACpC,IAAI;QACFK,KAAI,CAACf,MAAM,CAACiB,WAAW,CAACL,MAAM,CAAC;OAChC,CAAC,OAAOT,CAAC,EAAE;QACVK,OAAO,CAACC,IAAI,CAAC,uCAAuC,CAAC;QACrDX,UAAU,CAACe,OAAO,CAAC,IAAIA,OAAO,EAAE;;IAEpC,CAAC,CAAC;EACJ,CAAC;EAEDF,0BAAO,GAAP;IACE,IAAI,CAACX,MAAM,CAACkB,SAAS,EAAE;EACzB,CAAC;EACH,eAAC;AAAD,CAAC,EA9BD;AAgCA,OAAM,SAAUC,YAAY,CAACC,CAAM;EACjC,IAAI,OAAOC,MAAM,KAAK,WAAW,EAAE;EAEnC,IAAIC,IAAI;EACR,IAAI;IACFA,IAAI,GAAG,IAAIC,IAAI,CAAC,CAACH,CAAC,CAACI,QAAQ,EAAE,CAAC,EAAE;MAAEC,IAAI,EAAE;IAAwB,CAAE,CAAC;GACpE,CAAC,OAAOtB,CAAC,EAAE;IACV;IACAmB,IAAI,GAAG,IAAID,MAAM,CAACK,WAAW,EAAE;IAC/BJ,IAAI,CAACK,MAAM,CAACP,CAAC,CAACI,QAAQ,EAAE,CAAC;IACzBF,IAAI,GAAGA,IAAI,CAACM,OAAO,EAAE;;EAGvB,OAAO,IAAIjB,QAAQ,CAACkB,GAAG,CAACC,eAAe,CAACR,IAAI,CAAC,CAAC;AAChD","names":["isFunction","url","worker","Worker","onmessage","e","queue","shift","resolve","onmessageerror","console","warn","reject","MyWorker","params","onError","Promise","_this","push","postMessage","terminate","createWorker","f","window","blob","Blob","toString","type","BlobBuilder","append","getBlob","URL","createObjectURL"],"sources":["/home/iam/Documents/network/node_modules/@antv/g2/src/geometry/label/util/createWorker.ts"],"sourcesContent":["import { isFunction } from '@antv/util';\n\nclass MyWorker {\n  queue: any[] = [];\n  worker: Worker;\n\n  constructor(url) {\n    this.worker = new Worker(url);\n    this.worker.onmessage = (e: MessageEvent) => {\n      this.queue.shift()?.resolve(e);\n    };\n    this.worker.onmessageerror = (e: MessageEvent) => {\n      console.warn('[AntV G2] Web worker is not available');\n      this.queue.shift()?.reject(e);\n    };\n  }\n\n  post(params, onError?: () => any): Promise<MessageEvent> {\n    return new Promise((resolve, reject) => {\n      this.queue.push({ resolve, reject });\n      try {\n        this.worker.postMessage(params);\n      } catch (e) {\n        console.warn('[AntV G2] Web worker is not available');\n        isFunction(onError) && onError();\n      }\n    });\n  }\n\n  destroy() {\n    this.worker.terminate();\n  }\n}\n\nexport function createWorker(f: any) {\n  if (typeof window === 'undefined') return;\n\n  let blob;\n  try {\n    blob = new Blob([f.toString()], { type: 'application/javascript' });\n  } catch (e) {\n    // @ts-ignore\n    blob = new window.BlobBuilder();\n    blob.append(f.toString());\n    blob = blob.getBlob();\n  }\n\n  return new MyWorker(URL.createObjectURL(blob));\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}